= Model Context Protocol (MCP)

The link:https://modelcontextprotocol.org/docs/concepts/architecture[Model Context Protocol] (MCP) is a standardized protocol that enables AI models to interact with external tools and resources in a structured way. 
It supports multiple transport mechanisms to provide flexibility across different environments.

The link:https://modelcontextprotocol.io/sdk/java/mcp-overview[MCP Java SDK] provides a Java implementation of the Model Context Protocol, enabling standardized interaction with AI models and tools through both synchronous and asynchronous communication patterns.

`**Spring AI MCP**` extends the MCP Java SDK with Spring Boot integration, providing both xref:api/mcp/mcp-client-boot-starter-docs.adoc[client] and xref:api/mcp/mcp-server-boot-starter-docs.adoc[server] starters. 
Bootstrap your AI applications with MCP support using link:https://start.spring.io[Spring Initializer].

== MCP Java SDK Architecture

TIP: This section provides an overview for the link:https://modelcontextprotocol.io/sdk/java[MCP Java SDK architecture]. 
For the Spring AI MCP integration, refer to the xref:#_spring_ai_mcp_integration[Spring AI MCP Boot Starters] documentation.

The Java MCP implementation follows a three-layer architecture:

|===
|  |
^a| image::mcp/mcp-stack.svg[MCP Stack Architecture]
a| * *Client/Server Layer*: The McpClient handles client-side operations while the McpServer manages server-side protocol operations. Both utilize McpSession for communication management.
* *Session Layer (McpSession)*: Manages communication patterns and state through the McpClientSession and McpServerSession implementations.
* *Transport Layer (McpTransport)*: Handles JSON-RPC message serialization and deserialization with support for multiple transport implementations.
|===

|===
| link:https://modelcontextprotocol.io/sdk/java/mcp-client[MCP Client] |

a| The MCP Client is a key component in the Model Context Protocol (MCP) architecture, responsible for establishing and managing connections with MCP servers. It implements the client-side of the protocol, handling:

* Protocol version negotiation to ensure compatibility with servers
* Capability negotiation to determine available features
* Message transport and JSON-RPC communication
* Tool discovery and execution
* Resource access and management
* Prompt system interactions
* Optional features:
** Roots management
** Sampling support
* Synchronous and asynchronous operations
* Transport options:
** Stdio-based transport for process-based communication
** Java HttpClient-based SSE client transport
** WebFlux SSE client transport for reactive HTTP streaming

^a| image::mcp/java-mcp-client-architecture.jpg[Java MCP Client Architecture, width=500]
|===

|===
| link:https://modelcontextprotocol.io/sdk/java/mcp-server[MCP Server] |

a| The MCP Server is a foundational component in the Model Context Protocol (MCP) architecture that provides tools, resources, and capabilities to clients. It implements the server-side of the protocol, responsible for:

* Server-side protocol operations implementation
** Tool exposure and discovery
** Resource management with URI-based access
** Prompt template provision and handling
** Capability negotiation with clients
** Structured logging and notifications
* Concurrent client connection management
* Synchronous and Asynchronous API support
* Transport implementations:
** Stdio-based transport for process-based communication
** Servlet-based SSE and Streamable-HTTP server transports
** WebFlux SSE and Streamable-HTTP server transports for reactive HTTP streaming
** WebMVC SSE and Streamable-HTTP server transports for servlet-based HTTP streaming

^a| image::mcp/java-mcp-server-architecture.jpg[Java MCP Server Architecture, width=600]
|===

For detailed implementation guidance, using the low-level MCP Client/Server APIs, refer to the link:https://modelcontextprotocol.io/sdk/java[MCP Java SDK documentation].
For simplified setup using Spring Boot, use the MCP Boot Starters described below.

== Spring AI MCP Integration

Spring AI provides MCP integration through the following Spring Boot starters:

=== link:mcp-client-boot-starter-docs.html[Client Starters]

* `spring-ai-starter-mcp-client` - Core starter providing `STDIO` and HTTP-based `SSE` and `Streamable-HTTP` support
* `spring-ai-starter-mcp-client-webflux` - WebFlux-based `SSE` and `Streamable-HTTP` transport implementation

=== link:mcp-server-boot-starter-docs.html[Server Starters]

==== STDIO

[options="header"]
|===
|Server Type | Dependency | Property
| xref:api/mcp/mcp-stdio-sse-server-boot-starter-docs.adoc[Standard Input/Output (STDIO)] | `spring-ai-starter-mcp-server` | `spring.ai.mcp.server.stdio=true`
|===

==== WebMVC

|===
|Server Type | Dependency | Property
| xref:api/mcp/mcp-stdio-sse-server-boot-starter-docs.adoc#_sse_webmvc_serve[SSE WebMVC] | `spring-ai-starter-mcp-server-webmvc` | `spring.ai.mcp.server.protocol=SSE` or empty
| xref:api/mcp/mcp-streamable-http-server-boot-starter-docs.adoc#_streamable_http_webmvc_server[Streamable-HTTP WebMVC] | `spring-ai-starter-mcp-server-webmvc` | `spring.ai.mcp.server.protocol=STREAMABLE`
| xref:api/mcp/mcp-stateless-server-boot-starter-docs.adoc#_stateless_webmvc_server[Stateless WebMVC] | `spring-ai-starter-mcp-server-webmvc` | `spring.ai.mcp.server.protocol=STATLESS`
|===

==== WebMVC (Reactive)
|===
|Server Type | Dependency | Property
| xref:api/mcp/mcp-stdio-sse-server-boot-starter-docs.adoc#_sse_webflux_serve[SSE WebFlux] | `spring-ai-starter-mcp-server-webflux` | `spring.ai.mcp.server.protocol=SSE` or empty
| xref:api/mcp/mcp-streamable-http-server-boot-starter-docs.adoc#_streamable_http_webflux_server[Streamable-HTTP WebFlux] | `spring-ai-starter-mcp-server-webflux` | `spring.ai.mcp.server.protocol=STREAMABLE`
| xref:api/mcp/mcp-stateless-server-boot-starter-docs.adoc#_stateless_webflux_server[Stateless WebFlux] | `spring-ai-starter-mcp-server-webflux` | `spring.ai.mcp.server.protocol=STATLESS`
|===

== xref:api/mcp/mcp-annotations-overview.adoc[Spring AI MCP Annotations]

In addition to the programmatic MCP client & server configuration, Spring AI provides annotation-based method handling for MCP servers and clients through the xref:api/mcp/mcp-annotations-overview.adoc[MCP Annotations] module. 
This approach simplifies the creation and registration of MCP operations using a clean, declarative programming model with Java annotations.

The MCP Annotations module enables developers to:

* Create MCP tools, resources, and prompts using simple annotations
* Handle client-side notifications and requests declaratively
* Reduce boilerplate code and improve maintainability
* Automatically generate JSON schemas for tool parameters
* Access special parameters and context information

Key features include:   

* xref:api/mcp/mcp-annotations-server.adoc[Server Annotations]: `@McpTool`, `@McpResource`, `@McpPrompt`, `@McpComplete`
* xref:api/mcp/mcp-annotations-client.adoc[Client Annotations]: `@McpLogging`, `@McpSampling`, `@McpElicitation`, `@McpProgress`
* xref:api/mcp/mcp-annotations-special-params.adoc[Special Parameters]: `McpSyncServerExchange`, `McpAsyncServerExchange`, `McpTransportContext`, `McpMeta`
* **Automatic Discovery**: Annotation scanning with configurable package inclusion/exclusion
* **Spring Boot Integration**: Seamless integration with MCP Boot Starters

== Additional Resources

* xref:api/mcp/mcp-annotations-overview.adoc[MCP Annotations Documentation]
* link:mcp-client-boot-starter-docs.html[MCP Client Boot Starters Documentation]
* link:mcp-server-boot-starter-docs.html[MCP Server Boot Starters Documentation]
* link:mcp-helpers.html[MCP Utilities Documentation]
* link:https://modelcontextprotocol.github.io/specification/[Model Context Protocol Specification]
